"use strict";(self["webpackChunkse_project"]=self["webpackChunkse_project"]||[]).push([[901],{92584:function(e,t,o){o.r(t),o.d(t,{default:function(){return u}});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Profile"},[o("Header",{attrs:{id:"header",initialUsername:e.form.name}}),o("div",{style:{"min-height":e.mainMinHeight+"px"},attrs:{id:"main"}},[o("el-row",{attrs:{type:"flex",justify:"center"}},[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-box"},[o("el-row",[o("el-col",{attrs:{span:6}},[o("div",{staticClass:"profile-content"},[o("div",{staticClass:"profilePic"},[e.isOwnProfile?o("el-upload",{attrs:{id:"avatar-uploader",action:"","http-request":e.uploadAvatar,"show-file-list":!1,accept:"image/jpeg,image/gif,image/png,image/jpg"}},[e.form.imageUrl?o("el-avatar",{attrs:{shape:"square",size:256,src:e.form.imageUrl}}):o("el-avatar",{attrs:{shape:"square",size:256,icon:"el-icon-user-solid"}}),o("div",{attrs:{id:"change-pic"}},[e._v("更换头像")])],1):o("div",[e.form.imageUrl?o("el-avatar",{attrs:{shape:"square",size:256,src:e.form.imageUrl}}):o("el-avatar",{attrs:{shape:"square",size:256,icon:"el-icon-user-solid"}})],1)],1)])]),o("el-col",{attrs:{span:15}},[o("div",{staticClass:"profile-content"},[o("el-row",[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-text1"},[e._v("名字 :")]),e.form.isEdit?o("el-input",{attrs:{placeholder:"请输入新昵称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}):o("span",{staticClass:"profile-text2"},[e._v(" "+e._s(e.form.name))])],1)])],1),o("el-row",[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-text1"},[e._v("性别 :")]),o("span",{staticClass:"profile-text2"},[e._v(" "+e._s(e.form.sexWord))])])])],1),o("el-row",[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-text1"},[e._v("生日 :")]),o("span",{staticClass:"profile-text2"},[e._v(" "+e._s(e.form.dob))])])])],1),o("el-row",[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-text1"},[e._v("邮箱 :")]),o("span",{staticClass:"profile-text2"},[e._v(" "+e._s(e.form.email))])])])],1),o("el-row",[o("el-col",{attrs:{span:20}},[o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-text1"},[e._v("自我介绍 :")]),o("span",{staticClass:"profile-text2"},[e._v(" "+e._s(e.form.about))])])])],1)],1)]),o("el-dialog",{attrs:{title:"编辑个人信息",visible:e.changeVisible,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.changeVisible=t}}},[o("el-form",{attrs:{"label-position":"top",model:e.form}},[o("el-form-item",{attrs:{label:"名字","label-width":e.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",maxlength:"10","show-word-limit":""},model:{value:e.form.nameTemp,callback:function(t){e.$set(e.form,"nameTemp",t)},expression:"form.nameTemp"}})],1),o("el-form-item",{attrs:{label:"性别"}},[o("el-radio-group",{model:{value:e.form.sexTemp,callback:function(t){e.$set(e.form,"sexTemp",t)},expression:"form.sexTemp"}},[o("el-radio",{attrs:{label:"M"}},[e._v("男")]),o("el-radio",{attrs:{label:"F"}},[e._v("女")]),o("el-radio",{attrs:{label:"O"}},[e._v("其他")])],1)],1),o("el-form-item",{attrs:{label:"生日"}},[o("el-col",{attrs:{span:11}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择你的生日日期","value-format":"yyyy-MM-dd"},model:{value:e.form.dobTemp,callback:function(t){e.$set(e.form,"dobTemp",t)},expression:"form.dobTemp"}})],1)],1),o("el-form-item",{attrs:{label:"自我介绍","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"textarea",autosize:"",autocomplete:"off","show-word-limit":"",resize:"none"},model:{value:e.form.aboutTemp,callback:function(t){e.$set(e.form,"aboutTemp",t)},expression:"form.aboutTemp"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cancelChanges}},[e._v("取消")]),o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.updateProfileInfo}},[e._v("完成编辑")])],1)],1),o("el-col",{attrs:{span:3}},[o("div",{staticClass:"profile-content"},[e.isOwnProfile?o("el-button",{staticClass:"Edit",on:{click:function(t){e.changeVisible=!0}}},[e._v("编辑资料")]):e._e()],1)])],1)],1)])],1),o("el-row",{attrs:{type:"flex",justify:"center"}},[o("el-col",{attrs:{span:20}},e._l(e.feeds,(function(e){return o("FeedBox",{key:e.id,attrs:{initialFeedId:e.id,initialIsGroup:!1,initialIsPin:!1,initialIsFeatured:!1,initialIsAdmin:!1}})})),1)],1)],1),o("Footer",{attrs:{id:"footer"}}),o("el-backtop",{attrs:{target:".Profile"}},[o("i",{staticClass:"el-icon-arrow-up",staticStyle:{color:"#456268"}})])],1)},r=[],s=o(16198),i=(o(78975),o(68309),o(13083)),n=o(43445),l=o(75095),m=o(22282),f={name:"Profile",components:{Header:i.Z,Footer:n.Z,FeedBox:l.Z},watch:{$route:{handler:"profileReload"}},data:function(){return{userId:"123456",isOwnProfile:!1,fullscreenLoading:!1,form:{imageUrl:"",isEdit:!1,id:"",name:"",nameTemp:"",sexWord:"",sex:"",sexTemp:"",dob:"",dobTemp:"",email:"",about:"",aboutTemp:""},changeVisible:!1,formLabelWidth:"120px",feeds:[],mainMinHeight:""}},created:function(){var e;(e=m.Z.getters.getUser(m.Z.state()))&&(this.userId=e.user.id,this.userId==this.$route.params.id&&(this.isOwnProfile=!0)),this.getProfile(),this.getFeed()},mounted:function(){this.mainMinHeight=document.documentElement.clientHeight-$("#header").outerHeight(!0)-$("#footer").outerHeight(!0)-6},methods:{profileReload:function(){location.reload()},uploadAvatar:function(e){var t=this;return(0,s.Z)(regeneratorRuntime.mark((function o(){var a,r;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=new FormData,a.append("email",t.form.email),a.append("username",t.form.name),a.append("profile",e.file),a.append("userId",t.form.id),console.log(e.file),r={},localStorage.getItem("token")&&(r={Authorization:"Bearer "+localStorage.getItem("token")}),o.next=10,t.$axios({method:"put",url:"/api/v1/user/"+t.$route.params.id,data:a,headers:r}).then((function(e){console.log(e),t.form.imageUrl=e.data.profile,location.reload()})).catch((function(e){console.log(e)}));case 10:case"end":return o.stop()}}),o)})))()},getFeed:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o={},localStorage.getItem("token")&&(o={Authorization:"Bearer "+localStorage.getItem("token")}),t.next=4,e.$axios({method:"get",url:"/api/v1/feed/list?createdBy="+e.$route.params.id,headers:o}).then((function(t){e.feeds=t.data.results,console.log(e.feeds)})).catch((function(e){console.log(e)}));case 4:case"end":return t.stop()}}),t)})))()},getProfile:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.$route.params.id),t.next=3,e.$axios({method:"get",url:"/api/v1/user/"+e.$route.params.id}).then((function(t){var o=t.data;console.log(o),e.form.id=o.id,e.form.name=o.username,e.form.nameTemp=o.username,e.form.sex=o.gender,e.form.sexTemp=o.gender,console.log(e.form.sexTemp),e.form.dob=o.dob,e.form.dobTemp=o.dob,e.form.email=o.email,e.form.about=o.about,e.form.aboutTemp=o.about,o.profile&&(e.form.imageUrl=o.profile),"M"==e.form.sex&&(e.form.sexWord="男"),"F"==e.form.sex&&(e.form.sexWord="女"),"O"==e.form.sex&&(e.form.sexWord="其他")})).catch((function(t){e.$message.warning(t)}));case 3:case"end":return t.stop()}}),t)})))()},cancelChanges:function(){this.changeVisible=!1,this.form.nameTemp=this.form.name,this.form.aboutTemp=this.form.about,this.form.sexTemp=this.form.sex,this.form.dobTemp=this.form.dob},updateProfileInfo:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fullscreenLoading=!0,o=new FormData,o.append("email",e.form.email),o.append("username",e.form.nameTemp),o.append("userId",e.form.id),o.append("about",e.form.aboutTemp),o.append("gender",e.form.sexTemp),o.append("dob",e.form.dobTemp),a={},localStorage.getItem("token")&&(a={Authorization:"Bearer "+localStorage.getItem("token")}),t.next=12,e.$axios({method:"put",url:"/api/v1/user/"+e.$route.params.id,data:o,headers:a}).then((function(t){console.log(t),e.form.name=e.form.nameTemp,e.form.about=e.form.aboutTemp,e.form.dob=e.form.dobTemp,e.form.sex=e.form.sexTemp,"M"==e.form.sex&&(e.form.sexWord="男"),"F"==e.form.sex&&(e.form.sexWord="女"),"O"==e.form.sex&&(e.form.sexWord="其他"),e.changeVisible=!1,e.fullscreenLoading=!1,setTimeout((function(){location.reload(!0)}),500),e.$message.success("恭喜！修改成功")})).catch((function(t){console.log(t),e.$message.warning("抱歉！用户名已被使用")}));case 12:case"end":return t.stop()}}),t)})))()}}},c=f,p=o(1001),d=(0,p.Z)(c,a,r,!1,null,"fdb73b6e",null),u=d.exports}}]);
//# sourceMappingURL=901-legacy.13cf207f.js.map