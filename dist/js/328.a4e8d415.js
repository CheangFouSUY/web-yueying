"use strict";(self["webpackChunkse_project"]=self["webpackChunkse_project"]||[]).push([[328],{4328:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Header"),s("el-row",{attrs:{justify:"center",type:"flex"}},[s("el-col",{attrs:{span:12}},[s("div",{staticClass:"manageGroup"},[s("span",[e._v("管理员申请")])])])],1),e._l(e.requestList,(function(t){return s("el-row",{key:t.id,attrs:{justify:"center",type:"flex"}},[s("el-col",{attrs:{span:12}},[s("div",{staticClass:"adminRequest"},[t.profile?s("el-avatar",{attrs:{id:"userAvatar",src:t.profile}}):s("el-avatar",{attrs:{id:"userAvatar",icon:"el-icon-user-solid"}}),s("span",{attrs:{id:"itemUsername"}},[e._v(e._s(t.username))]),s("el-button",{staticClass:"accdecButton",attrs:{type:"success",round:""},on:{click:function(s){return e.acceptRequest(t.id)}}},[e._v("同意")]),s("el-button",{staticClass:"accdecButton",attrs:{type:"danger",round:""},on:{click:function(s){return e.declineRequest(t.id)}}},[e._v("拒绝")])],1)])],1)})),s("el-row",{attrs:{justify:"center",type:"flex"}},[0==e.requestList.length?s("el-col",{attrs:{span:12}},[s("div",{staticClass:"noRequest"},[s("span",[e._v("抱歉！目前暂无申请")])])]):e._e()],1)],2)},a=[],o=s(3083),i=s(3445),n=s(2282),u={name:"Manage Group",components:{Header:o.Z,Footer:i.Z},data(){return{requestList:[],userId:"",isOwnerOrAdmin:!1,admin:[],mainadmin:[]}},methods:{getRequest(){this.$axios({method:"get",url:"/api/v1/group/requestuser/"+this.$route.params.id}).then((e=>{console.log(e),console.log(e.data.results.length),this.requestList=e.data.results})).catch((e=>{console.log(e)}))},acceptRequest(e){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"put",url:"/api/v1/group/setRole/"+this.$route.params.id+"/"+e+"/2",headers:t}).then((e=>{console.log(e),this.$message.success("同意成功！"),setTimeout((function(){location.reload(!0)}),500)})).catch((e=>{console.log(e)}))},declineRequest(e){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"put",url:"/api/v1/group/setRole/"+this.$route.params.id+"/"+e+"/3",headers:t}).then((e=>{console.log(e),this.$message.success("拒绝成功！"),setTimeout((function(){location.reload(!0)}),500)})).catch((e=>{console.log(e)}))},async getGroupInfo(){await this.$axios.all([this.getGroupMainAdmin(),this.getGroupAdmin()]).then(this.$axios.spread(((e,t)=>{this.admin=t.data.results,this.mainadmin=e.data.results;for(let s=0;s<t.data.results.length;s++)if(t.data.results[s].id===this.userId){this.isOwnerOrAdmin=!0;break}e.data.results[0].id===this.userId&&(this.isOwnerOrAdmin=!0),this.isOwnerOrAdmin||this.$router.push({path:"/group/"+this.$route.params.id}),console.log(this.isOwnerOrAdmin)}))).catch((e=>{console.log(e)}))},getGroupMainAdmin(){return this.$axios({method:"get",url:"/api/v1/group/members/"+this.$route.params.id+"?role=1"})},getGroupAdmin(){return this.$axios({method:"get",url:"/api/v1/group/members/"+this.$route.params.id+"?role=2"})}},mounted(){this.getRequest(),this.getGroupInfo()},created(){var e;(e=n.Z.getters.getUser(n.Z.state()))&&e.user.confirmed&&(this.userId=e.user.id)}},l=u,c=s(1001),d=(0,c.Z)(l,r,a,!1,null,"3f8a0282",null),h=d.exports}}]);
//# sourceMappingURL=328.a4e8d415.js.map