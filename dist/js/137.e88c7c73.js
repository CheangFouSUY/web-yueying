"use strict";(self["webpackChunkse_project"]=self["webpackChunkse_project"]||[]).push([[137],{3208:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"all"},[i("Header",{attrs:{id:"header"}}),i("div",{style:{"min-height":e.mainMinHeight+"px"},attrs:{id:"main"}},[e._m(0),i("el-row",{staticClass:"tag-box"},e._l(e.tags.slice(0,9),(function(t){return i("span",{key:t.id,on:{click:function(i){return e.enterTag(t.id)}}},[e._v(" #"+e._s(t.title)+"# ")])})),0),e._l(e.notGroupFeeds.slice(0,20),(function(e){return i("FeedBox",{key:e.id,attrs:{initialFeedId:e.id,initialIsInnerpage:!1,initialIsPin:!1,initialIsFeatured:!1,initialIsAdmin:!1}})}))],2),i("Footer",{attrs:{id:"footer"}}),i("el-backtop",{attrs:{target:".all"}},[i("i",{staticClass:"el-icon-arrow-up",staticStyle:{color:"#456268"}})])],1)},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-title"},[s("img",{attrs:{src:i(6607),alt:"feed icon"}}),s("span",[e._v("话题广场")])])}],n=i(3083),a=i(3445),r=i(5095),l=i(2282),g={name:"FeedMainpage",components:{Header:n.Z,Footer:a.Z,FeedBox:r.Z},data(){return{islogin:!1,user:"",activeName:"all",formVisible:!1,form:{title:"",description:"",img:""},dataList:"",feeds:[],tags:[],mainMinHeight:""}},mounted(){var e;(e=l.Z.getters.getUser(l.Z.state()))&&(this.islogin=!0,this.userId=e.user.id),this.getTag(),this.getFeed(),this.mainMinHeight=document.documentElement.clientHeight-$("#header").outerHeight(!0)-$("#footer").outerHeight(!0)-6},computed:{notGroupFeeds(){return this.feeds.filter((e=>e.isPublic))}},methods:{handleChange(e,t){this.form.img=e.raw,console.log(this.form.img)},handleExceed(e,t){this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},postFeed(){if(!this.form.title)return void this.$notify({showClose:!0,type:"warning",title:"标题不能为空",position:"top-left"});if(this.form.description.length<25)return void this.$notify({showClose:!0,type:"warning",title:"帖子内容不能少于25字",position:"top-left"});let e=new FormData;e.append("title",this.form.title),e.append("description",this.form.description),e.append("img",this.form.img);var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"post",url:"/api/v1/feed/",data:e,headers:t}).then((e=>{switch(console.log(e),this.formVisible=!1,e.status){case 201:this.$notify({showClose:!0,message:"已发表帖子",type:"success",position:"top-left"}),setTimeout((function(){location.reload()}),1500);break}})).catch((e=>{switch(console.log(e),e.response.status){case 400:this.$notify({title:"标题和内容不能为空！",type:"warning",position:"top-left"});break;case 401:this.$notify({title:"请先加入小组！",type:"warning",position:"top-left"});break}}))},getTag(){this.$axios({method:"get",url:"/api/v1/tag/list"}).then((e=>{console.log(e),this.tags=e.data.results,console.log(this.tags)})).then((e=>{console.log(e)}))},getFeed(){var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"get",url:"/api/v1/feed/list?orderBy=l",headers:e}).then((e=>{console.log(e),this.feeds=e.data.results,console.log(this.feeds);for(let t=0;t<this.feeds.length;t++)this.feeds[t].isPublic&&(this.notGroupFeedsLen+=1,console.log("not Group Feeds + 1"))}))},getImg(e){var t=e.target.files[0].name;$(".showFileName").html(t),console.log(t),this.form.img=e.target.files[0],console.log("get img! ",this.form)},enterTag(e){this.$router.push({path:`/tag/${e}`})}}},h=g,d=i(1001),c=(0,d.Z)(h,s,o,!1,null,"1e964413",null),m=c.exports},6607:function(e,t,i){e.exports=i.p+"img/Feed.d85c2d00.svg"}}]);
//# sourceMappingURL=137.e88c7c73.js.map