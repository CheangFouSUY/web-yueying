"use strict";(self["webpackChunkse_project"]=self["webpackChunkse_project"]||[]).push([[137],{13208:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"all"},[i("Header",{attrs:{id:"header"}}),i("div",{style:{"min-height":t.mainMinHeight+"px"},attrs:{id:"main"}},[t._m(0),i("el-row",{staticClass:"tag-box"},t._l(t.tags.slice(0,9),(function(e){return i("span",{key:e.id,on:{click:function(i){return t.enterTag(e.id)}}},[t._v(" #"+t._s(e.title)+"# ")])})),0),t._l(t.notGroupFeeds.slice(0,20),(function(t){return i("FeedBox",{key:t.id,attrs:{initialFeedId:t.id,initialIsInnerpage:!1,initialIsPin:!1,initialIsFeatured:!1,initialIsAdmin:!1}})}))],2),i("Footer",{attrs:{id:"footer"}}),i("el-backtop",{attrs:{target:".all"}},[i("i",{staticClass:"el-icon-arrow-up",staticStyle:{color:"#456268"}})])],1)},n=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page-title"},[o("img",{attrs:{src:i(36607),alt:"feed icon"}}),o("span",[t._v("话题广场")])])}],s=(i(57327),i(41539),i(92222),i(68309),i(82526),i(41817),i(13083)),a=i(43445),r=i(75095),l=i(22282),c={name:"FeedMainpage",components:{Header:s.Z,Footer:a.Z,FeedBox:r.Z},data:function(){return{islogin:!1,user:"",activeName:"all",formVisible:!1,form:{title:"",description:"",img:""},dataList:"",feeds:[],tags:[],mainMinHeight:""}},mounted:function(){var t;(t=l.Z.getters.getUser(l.Z.state()))&&(this.islogin=!0,this.userId=t.user.id),this.getTag(),this.getFeed(),this.mainMinHeight=document.documentElement.clientHeight-$("#header").outerHeight(!0)-$("#footer").outerHeight(!0)-6},computed:{notGroupFeeds:function(){return this.feeds.filter((function(t){return t.isPublic}))}},methods:{handleChange:function(t,e){this.form.img=t.raw,console.log(this.form.img)},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))},beforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},postFeed:function(){var t=this;if(this.form.title)if(this.form.description.length<25)this.$notify({showClose:!0,type:"warning",title:"帖子内容不能少于25字",position:"top-left"});else{var e=new FormData;e.append("title",this.form.title),e.append("description",this.form.description),e.append("img",this.form.img);var i={};localStorage.getItem("token")&&(i={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"post",url:"/api/v1/feed/",data:e,headers:i}).then((function(e){switch(console.log(e),t.formVisible=!1,e.status){case 201:t.$notify({showClose:!0,message:"已发表帖子",type:"success",position:"top-left"}),setTimeout((function(){location.reload()}),1500);break}})).catch((function(e){switch(console.log(e),e.response.status){case 400:t.$notify({title:"标题和内容不能为空！",type:"warning",position:"top-left"});break;case 401:t.$notify({title:"请先加入小组！",type:"warning",position:"top-left"});break}}))}else this.$notify({showClose:!0,type:"warning",title:"标题不能为空",position:"top-left"})},getTag:function(){var t=this;this.$axios({method:"get",url:"/api/v1/tag/list"}).then((function(e){console.log(e),t.tags=e.data.results,console.log(t.tags)})).then((function(t){console.log(t)}))},getFeed:function(){var t=this,e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"get",url:"/api/v1/feed/list?orderBy=l",headers:e}).then((function(e){console.log(e),t.feeds=e.data.results,console.log(t.feeds);for(var i=0;i<t.feeds.length;i++)t.feeds[i].isPublic&&(t.notGroupFeedsLen+=1,console.log("not Group Feeds + 1"))}))},getImg:function(t){var e=t.target.files[0].name;$(".showFileName").html(e),console.log(e),this.form.img=t.target.files[0],console.log("get img! ",this.form)},enterTag:function(t){this.$router.push({path:"/tag/".concat(t)})}}},g=c,u=i(1001),f=(0,u.Z)(g,o,n,!1,null,"1e964413",null),d=f.exports},36607:function(t,e,i){t.exports=i.p+"img/Feed.d85c2d00.svg"}}]);
//# sourceMappingURL=137-legacy.29d56d19.js.map